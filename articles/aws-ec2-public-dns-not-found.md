---
title: "【解決】AWS EC2でパブリックDNS/IPが割り当てられない問題"
emoji: "📚"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["aws", "ec2", "dns", "問題"]
published: true
---

こんにちは。今回は、awsについて初心者エンジニアに向けて、ec2とdnsに関する問題についてご紹介します。awsは、クラウドインフラストラクチャの中でも特に利用されやすく、便利なサービスですが、初めて触ると戸惑うことも多いです。そこで、ec2とdnsについて詳しく解説し、公開dns/ipが割り当てられない問題を解決する方法をお伝えします。

### awsとは？

aws(amazon web services)は、amazonが提供する、クラウドコンピューティングプラットフォームです。クラウド上で様々なサービスやアプリケーションを実行することができます。awsは、仮想サーバーのec2や、データストレージのs3、データベースのrdsなど、多数のサービスを提供しています。

### ec2とdns

ec2は、awsで提供される仮想サーバーです。ec2を使うことで、ネットワークに接続された仮想マシンを作成できます。ec2のインスタンスは、パブリックipアドレス、プライベートipアドレス、パブリックdnsを持っています。この中でも、パブリックipアドレス、パブリックdnsは、外部からのアクセスに必要な情報です。

パブリックdnsは、ec2インスタンスに対して割り当てられるホストネームです。このパブリックdnsを使うことで、外部からアクセスできるようになります。通常は、ec2インスタンスを起動すると、自動的にパブリックdnsが割り当てられます。

しかし、パブリックdnsが割り当てられない場合があります。以下に、その原因を挙げます。

1. インスタンスが削除された場合
2. インスタンスが停止された場合
3. dnsレコードが無効になっている場合

### aws ec2でパブリックdnsが割り当てられない問題の解決方法

パブリックdnsが割り当てられない問題は、主に上記の3つの原因によるものです。それぞれの原因によって、解決方法が異なります。

以下に、それぞれの原因と解決方法を解説します。

#### 1. インスタンスが削除された場合

インスタンスが削除された場合、そのインスタンスに紐づいていたパブリックdnsも削除されます。そのため、新しいインスタンスを作成しても、前のインスタンスとは異なるパブリックdnsが割り当てられます。

この場合、新しいパブリックdnsを割り当てるためには、以下の手順を実行します。

1. awsマネジメントコンソールにログインします。
2. ec2ダッシュボードを開きます。
3. 左側のメニューから「elastic ip」を選択します。
4. 「allocate new address」をクリックします。
5. 新しいelastic ipを割り当てます。
6. 割り当てたelastic ipを選択して、「actions」→「associate ip address」をクリックします。
7. アソシエイトするec2インスタンスを選択し、「associate」をクリックします。

これで、新しいelastic ipがec2インスタンスにアタッチされ、新しいパブリックdnsが割り当てられます。

#### 2. インスタンスが停止された場合

インスタンスが停止された場合、ec2インスタンスに紐づくパブリックipアドレスとパブリックdnsは維持されます。ただし、ec2インスタンスを停止してしまうと、パブリックipアドレスが変わる場合があります。そのため、パブリックdnsも変更される可能性があります。

この場合、以下の手順でパブリックdnsを更新します。

1. awsマネジメントコンソールにログインします。
2. ec2ダッシュボードを開きます。
3. インスタンスリストから、停止しているec2インスタンスを選択します。
4. 「actions」→「instance settings」→「change termination protection」を選択します。
5. 「terminate protection cannot be disabled while the instance is stopped」という警告が表示されますが、それを無視して「enable termination protection」をクリックします。
6. ec2インスタンスを起動します。
7. インスタンスのステータスが「running」になったら、ステータス欄の「ipv4 public ip」を確認します。
8. 変更する必要があれば、「actions」から「associate ip address」をクリックして、新しいelastic ipを割り当てることができます。

#### 3. dnsレコードが無効になっている場合

dnsレコードが無効になっている場合、パブリックdnsが解決されないため、アクセスできなくなります。この場合は、awsが提供するroute53を利用して、dnsレコードを更新する必要があります。

以下に、dnsレコードの更新手順を記載します。

1. awsマネジメントコンソールにログインします。
2. route53ダッシュボードを開きます。
3. 対象のドメイン名をクリックします。
4. 対象のレコードを選択し、「edit」をクリックします。
5. 「value」欄に、更新するパブリックdnsを入力します。
6. 「save record set」をクリックして、変更を保存します。

以上の手順で、dnsレコードが更新されます。もし、手順に沿っても解決しない場合は、awsのサポートに問い合わせることもできます。

### おわりに

今回は、初心者エンジニアがawsのec2とdnsに関する問題を解決するための方法をご紹介しました。awsは、使えば使うほど便利で、多くのエンジニアに利用されています。ただし、初めて触ると戸惑うことも多いです。ec2とdnsがうまく動作しない場合は、上記の手順を参考にして解決していただけると幸いです。

:::message alert
注意：ec2は、料金が発生するサービスです。手続きを行う前に、料金について正確な情報を把握し、自己責任で操作を行ってください。
:::

## 0円でプログラミングを学ぶという選択
- [techacademyの無料体験](//af.moshimo.com/af/c/click?a_id=2612475&amp;p_id=1555&amp;pc_id=2816&amp;pl_id=22706&amp;url=https%3a%2f%2ftechacademy.jp%2fhtmlcss-trial%3futm_source%3dmoshimo%26utm_medium%3daffiliate%26utm_campaign%3dtextad)
- [オンラインスクール dmm webcamp pro](//af.moshimo.com/af/c/click?a_id=2612482&amp;p_id=1363&amp;pc_id=2297&amp;pl_id=39999&amp;guid=on)

